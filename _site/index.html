
<!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7 ie" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js lt-ie9 lt-ie8 ie" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js lt-ie9 ie" lang="en"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<title>Thoughts on JavaScript, AngularJS, and more</title>
	<meta name="author" content="Jonathan Guerrera">
	<link href='/assets/themes/the-minimum/css/style.css' rel="stylesheet" media="all">
	<link href="http://feeds.feedburner.com/" rel="alternate" title="Thoughts on JavaScript, AngularJS, and more" type="application/atom+xml">
	<script src="http://cdnjs.cloudflare.com/ajax/libs/modernizr/2.0.6/modernizr.min.js"></script>
</head>
<body>
<div id="page" class="hentry">
	<header class="the-header">
		<div class="unit-head">
			<div class="unit-inner unit-head-inner">
				<p class="logo"><a href="/">Jon the Coding Noob</a></p>
				<nav class="nav-global">
					<ul>
						<li class="archive"><a href="/archive.html">archive</a></li>
						<li class="page"><a href="/pages.html">pages</a></li>
						<li class="category"><a href="/categories.html">categories</a></li>
						<li class="tag"><a href="/tags.html">tags</a></li>
						<li class="forkme"><iframe src="http://markdotto.github.com/github-buttons/github-btn.html?user=plusjade&repo=jekyll-bootstrap&type=fork&count=true"
								allowtransparency="true" frameborder="0" scrolling="0" width="95px" height="20px"></iframe></li>
					</ul>
				</nav>
			</div><!-- unit-inner -->
		</div><!-- unit-head -->
	</header>
	<div class="body" role="main">
		<div class="unit-body">
			<div class="unit-inner unit-body-inner">
				<div class="entry-content">
					
<article class="unit-article layout-page">
	<div class="unit-inner unit-article-inner">
		<div class="content">
			<header>
				<div class="unit-head">
					<div class="unit-inner unit-head-inner">
						<h1 class="h2 entry-title">Thoughts on JavaScript, AngularJS, and more</h1>
					</div><!-- unit-inner -->
				</div><!-- unit-head -->
			</header>

			<div class="bd">
				<div class="entry-content">
					
<ul class="posts">
  <!--This code just lists out each posts title next a date with a link. Removing-->
<!--   
    <li><span>08 May 2014</span> &raquo; <a href="/2014/05/08/using-google-spreadsheets-or-excel-to-chart-your-success-through-life">Using Google Spreadsheets (or Excel) to Chart Your Success Through Life</a></li>
  
    <li><span>05 May 2014</span> &raquo; <a href="/2014/05/05/preventing-mysql-from-randomly-stopping-on-ubuntu-1204">Preventing MySQL from Randomly Stopping on Ubuntu 12.04</a></li>
  
    <li><span>05 Apr 2014</span> &raquo; <a href="/angularjs/2014/04/05/a-better-way-to-integrate-angularjs-and-google-charts">A Better Way to Integrate AngularJS and Google Charts</a></li>
  
    <li><span>04 Apr 2014</span> &raquo; <a href="/2014/04/04/installing-jekyll-on-os-x-1092">Installing Jekyll on OS X 10.9.2</a></li>
   -->

  <!--Added by Jon from: http://stackoverflow.com/questions/9794699/listing-all-the-blog-posts-with-content-with-jekyll-->
  
    <article class="unit-article layout-post">
    <div class="unit-inner unit-article-inner">
        <div class="content">
            <div class="bd">
            	<a href="/2014/05/08/using-google-spreadsheets-or-excel-to-chart-your-success-through-life"><h1>Using Google Spreadsheets (or Excel) to Chart Your Success Through Life</h1></a>
            	<small>08 May 2014</small>
            	<hr />
                <div class="entry-content">
                    
<p><em>This post originally appeared in my other blog, <a href="http://www.livingforimprovement.com">Living For Improvement</a>. However, given the technical nature of the lifehack at hand, I decided to cross-post it here. Enjoy!</em></p>

<p><img src="/assets/img/calendar-prototype.png" alt="Life Calendar prototype" /></p>

<p>For years now, I’ve been using a system called <a href="http://www.livingforimprovement.com/key-lifestyle-indicators-a-powerful-tool-for-long-term-success/">Key Lifestyle Indicators</a> (KLIs) that I modeled after the idea of <a href="http://en.wikipedia.org/wiki/Performance_indicator">Key Performance Indicators</a> in business. </p>

<p>My KLI definitions have changed over the years; here’s my current set-up:</p>

<p><img src="/assets/img/klis.png" alt="Key Lifestyle Indicators" /></p>

<p>This system works very well for me, consistently reminding me where I’m slacking and where I’m succeeding. The best part: it requires less than 10 seconds per day to enter the necessary information (nowadays it’s simply 1s and 0s transformed into a moving average).</p>

<p>It wasn’t until this past week that I found a way to leverage this tracked data in a new, interesting way. The inspiration came from reading <a href="http://www.waitbutwhy.com/2014/05/life-weeks.html">Wait But Why’s post</a> on what your life looks like plotted out into weeks (hint: You have less than 4,500 weeks in your life to spend – how have <em>you</em> been using them?). </p>

<p>I loved the idea of a meaningful reminder of the limited number of weeks we have on this planet. Thankfully, Wait But Why offers some <a href="http://store.waitbutwhy.com/collections/posters/products/life-calendar-12x18-hand-screen-printed">sweet calendars</a> that allow you to track how you’re living out your weeks – either with hand-scribbled notes or via color coding. </p>

<p>I’ll probably pick up one of these awesome calendars some time in the near future, but I wondered if I could use my years of KLI data to graphically represent this without needing to create yet <em>another</em> place to track my progress through life. </p>

<p>This post describes how I took my KLI data and created a Wait-But-Why-styled life calendar that lives in Google Spreadsheets (or Excel, if that’s your thing). If you track similar data in a spreadsheet, this article should help you in creating a similar set-up (read <a href="http://www.waitbutwhy.com/2014/05/life-weeks.html">Wait But Why’s post</a> for a deeper understanding of why a life calendar is awesome).</p>

<h3 id="step-1-prototype-the-end-result">Step 1: Prototype the end result</h3>

<p>Here’s what I wanted my life calendar to look like when all was said and done:</p>

<p><img src="/assets/img/calendar-prototype.png" alt="Life Calendar prototype" /></p>

<p>Note how I keep untracked weeks in gray, but everything else is colored yellow, green, or red depending on how my KLIs looked that week. The goal was to have this automatically calculated for me, as manually-inputted tracking can get quite annoying. But in order for this to become automated, I needed to pull together all of the necessary data, which brings me to step 2…</p>

<h3 id="step-2-survey-the-current-datascape">Step 2: Survey the current datascape</h3>

<p>The calendar prototype looked good, but the data I needed was siloed in different cells. In other words, because none of the data was rolled up by day or week, some intermediary data compilation was required before the calendar could pull what it needed. </p>

<p><img src="/assets/img/klis-data.png" alt="Key Lifestyle Indicators" /></p>

<h3 id="step-3-compile-the-calendar-data">Step 3: Compile the calendar data</h3>

<p>After surveying my data, I realized I needed to compile my data in two ways to transition to the life calendar:</p>

<ol>
  <li>Daily score sums…</li>
  <li>…rolled up into weekly score sums</li>
</ol>

<p>I ended up adding two additional columns into my KLI sheet (which I now keep hidden) to accomplish step 1. See below:</p>

<p><img src="/assets/img/new-kli-columns.png" alt="Key Lifestyle Indicators additional columns" /></p>

<p>I calculated the week of my life (Column L) using this formula: <code>=ROUNDDOWN((CURRENT_DATE - DATE_I_WAS_BORN +1)/7)</code>. The +1 in that formula ensures that the calculation includes today’s date when rounding down to the current week. </p>

<p>From there, I summed up each day’s scores using the sum of columns B, C, D, and E. For example, for the day on row 50, the M50 cell contained <code>=B50+C50+D50+E50</code>.</p>

<p>For step 2, I used a pivot table to keep an up-to-date weekly summary of my scores:</p>

<p><img src="/assets/img/kli-weekly-pivot.png" alt="Life Calendar Pivot Table" /></p>

<p>It rolls up all of the scores by week using the two new columns I showed in the previous screenshot. With my daily scores summed and rolled up by week, it was time to link this data to my calendar prototype. </p>

<h3 id="step-4-bring-the-calendar-to-life">Step 4: Bring the calendar to life</h3>

<p>This step was the most time intensive, so I broke into three main tasks:</p>

<h4 id="a-link-the-data-points-to-the-calendar">A. Link the data points to the calendar</h4>

<p>This task involved a VLOOKUP formula to pull the right score based on week. To pull from the right place in the pivot table, I simply needed to calculate the current week and then do the VLOOKUP. It’s a little heavy to look at, but it ended up looking like this: <code>=VLOOKUP(rounddown((CURRENT_YEAR*365)/7 + WEEK_INDEX+1),'Weekly Scores'!$A:$B,2, False)</code></p>

<p><img src="/assets/img/life-calendar-formula.png" alt="Life Calendar Pivot Table" /></p>

<p>Here’s a broader view with cell highlighting. Notice how it uses the Week Index and the current year to calculate the correct week of my life, and then runs the VLOOKUP based on that value:</p>

<p><img src="/assets/img/life-calendar-formula2.png" alt="Life Calendar Pivot Table" /></p>

<h4 id="b-handle-errors">B. Handle errors</h4>

<p>Although the VLOOKUP worked quite well, there were two errors I had to account for:</p>

<ol>
  <li>
    <p>The formula returns an error for future weeks that haven’t been calculated yet.</p>
  </li>
  <li>
    <p>A particular oddity with Google Spreadsheets was causing the VLOOKUP to lock the formula in place and make it uneditable (turns out this is a Google Spreadsheets bug when doing a VLOOKUP on pivot tables – hopefully this gets fixed soon). </p>
  </li>
</ol>

<p>To solve the first issue, it was rather easy. I wrapped the VLOOKUP in an IFERROR like so:</p>

<p><code>=IFERROR(VLOOKUP_GOES_HERE, "")</code></p>

<p>This made sure that the formula returned an empty string for future weeks, keeping the calendar clean and error-free. </p>

<p>To solve the second issue, I used a trick I found on <a href="http://webapps.stackexchange.com/questions/37556/google-spreadsheets-editing-of-a-vlookup-formula-that-references-a-pivot-table">Stack Exchange</a>. The trick involves arbitrarily adding a +0 to your VLOOKUP calculation. This won’t skew the calculation, obviously, and for some reason keeps the cell formula editable. </p>

<p>Here’s what the VLOOKUP looked like with the +0 added in:</p>

<p><code>VLOOKUP(rounddown((CURRENT_YEAR*365)/7 + WEEK_INDEX+1),'Weekly Scores'!$A:$B,2, False)+0</code></p>

<p>Problem solved!</p>

<p>With both errors handled, the final formula looked like this:</p>

<p><code>=IFERROR(VLOOKUP(rounddown((CURRENT_YEAR*365)/7 + WEEK_INDEX+1),'Weekly Scores'!$A:$B,2, False)+0, "")</code></p>

<h4 id="c-set-up-conditional-formatting-rules">C. Set up conditional formatting rules</h4>

<p>With the hard part out of the way, all I needed to do was make the cells color coded based on my score that week. </p>

<p>In my KLI system, the ideal day would earn me 4 points. Therefore, my ideal week would yield 28 points. With that in mind, here’s how I defined and color-coded great, ok, and bad weeks.</p>

<p><img src="/assets/img/life-cal-formatting.png" alt="Life Calendar Pivot Table" /></p>

<p>As you can see, 20 points or above is a good week, 15-20 points is a so-so week, and anything less is a red flag. Also notice how I alter the text color as well to hide the number calculation that lives in the cell.</p>

<h3 id="step-5-celebrate">Step 5: Celebrate!</h3>

<p>At this point, I took a step back and appreciated my sexy, new life calendar, auto-calculated based on the KLI system I’ve trusted for years. </p>

<p><img src="/assets/img/final-calendar.png" alt="Life Calendar Final Result" /></p>

<p><a href="http://waitbutwhy.com/about">Tim Urban</a>, if you’re reading this post, I just want to say thank you for the inspiration. I follow your blog religiously, and this obviously could not have come about without your wisdom. Cheers mate. </p>

<p>Now, off to appreciate the precious weeks I have left. </p>

                    <ul class="list-linear">
                        <li><div class="twitter-tweet"><a href="https://twitter.com/share?url=http://jrrera.github.io//2014/05/08/using-google-spreadsheets-or-excel-to-chart-your-success-through-life&amp;text=Using Google Spreadsheets (or Excel) to Chart Your Success Through Life" class="twitter-share-button" data-count="horizontal" data-via="jonguerrera" data-lang="en" data-url="http://jrrera.github.io//2014/05/08/using-google-spreadsheets-or-excel-to-chart-your-success-through-life">Tweet</a></div></li>
                        <li><div class="fb-share-button" data-href="/2014/05/08/using-google-spreadsheets-or-excel-to-chart-your-success-through-life" data-type="button_count"></div></li>
                        <li><div class="g-plusone" data-size="medium" data-href="/2014/05/08/using-google-spreadsheets-or-excel-to-chart-your-success-through-life"></div></li>
                    </ul>
                </div><!-- entry-content -->
            </div><!-- bd -->
        </div><!-- content -->
    </div><!-- unit-inner -->
    <hr />
    <hr />
</article>


  
    <article class="unit-article layout-post">
    <div class="unit-inner unit-article-inner">
        <div class="content">
            <div class="bd">
            	<a href="/2014/05/05/preventing-mysql-from-randomly-stopping-on-ubuntu-1204"><h1>Preventing MySQL from Randomly Stopping on Ubuntu 12.04</h1></a>
            	<small>05 May 2014</small>
            	<hr />
                <div class="entry-content">
                    
<p>I recently migrated my WordPress blog from GoDaddy to <a href="http://www.digitalocean.com">Digital Ocean</a>. Digital Ocean is a fantastic way to set up your own server at low cost, but it does require you to do a lot of the maintenance work yourself. </p>

<p>I was able to follow Digital Ocean’s <a href="https://www.digitalocean.com/community/articles/how-to-migrate-wordpress-from-shared-hosting-to-a-cloud-server-with-zero-downtime">guide</a> for migrating my previously existing WordPress blog, <a href="http://www.livingforimprovement.com">LivingForImprovement.com</a>, from GoDaddy to Digital Ocean, but one pain point I couldn’t resolve was MySQL randomly terminating itself due to low memory on my Digital Ocean droplet. Without MySQL running, blog posts couldn’t be fetched when people visited my blog. No bueno :(.</p>

<p><img src="/assets/img/mysql_off.png" alt="My blog isn't happy when MySQL shuts off" /></p>

<p>I made sure a <a href="https://www.digitalocean.com/community/articles/how-to-add-swap-on-ubuntu-12-04">swap file</a> was active on my droplet, but every week or so, MySQL would still terminate itself. Working with memcache also seemed like a viable option, but it looked a little bit over my head. While I do plan to learn memcache eventually, I decided to get my toes wet in the world of shell scripting to help manage the problem until I do.</p>

<p>It’s nothing special, but here’s what I did:</p>

<h3 id="step-1---create-a-simple-shell-script">Step 1 - Create a simple shell script</h3>

<div class="highlight"><pre><code class="bash">sudo nano /usr/local/sbin/mysql_check.sh
</code></pre></div>

<p>Then, I wrote the following: </p>

<div class="highlight"><pre><code class="bash"><span class="c">#!/bin/bash</span>
<span class="k">if</span> <span class="o">[[</span> ! <span class="s2">&quot;$(service mysql status)&quot;</span> <span class="o">=</span>~ <span class="s2">&quot;start/running&quot;</span> <span class="o">]]</span>
<span class="k">then</span>
<span class="k">    </span>service mysql start
    <span class="c"># echo &quot;Restarting MySql&quot; # Uncomment for debugging</span>
<span class="k">else</span>
    <span class="c"># echo &quot;Looks like MySql is running. No action taken&quot; # Uncomment for debugging</span>
<span class="k">fi</span>
</code></pre></div>

<p>Finally, make sure your script is executable:</p>

<div class="highlight"><pre><code class="bash">sudo chmod +x /usr/local/sbin/mysql_check.sh
</code></pre></div>

<h3 id="step-2---set-up-a-cron-job-to-check-mysqls-status-every-minute">Step 2 - Set up a cron job to check MySQL’s status every minute</h3>

<p>Until I sit down and learn the ins and outs of memcache, I’d prefer that this cron check every minute to make sure MySQL is running. I had to do this in root’s crontab, since the commands I’d need the script to run require root.</p>

<div class="highlight"><pre><code class="bash">sudo crontab -e
</code></pre></div>

<p>And within your root crontab:</p>

<div class="highlight"><pre><code class="bash"><span class="nv">PATH</span><span class="o">=</span>/usr/sbin:/usr/bin:/sbin:/bin
*/1 * * * * /usr/local/sbin/mysql_check.sh &gt;&gt; /home/jon/cronlog.log 2&gt;<span class="p">&amp;</span>1
</code></pre></div>

<p>I had to add the PATH variable to the script to allow crontab to run the commands in my shell script, such as <code>service mysql start</code> as per <a href="http://ubuntuforums.org/showthread.php?t=2022708">this article’s discussion</a>.</p>

<p>Just for debugging purposes, I’m routing any output to a log file in my home directory, just to initially measure how often the cron needs to restart MySQL. If you’re not curious about this, you can change the above to:</p>

<div class="highlight"><pre><code class="bash"><span class="nv">PATH</span><span class="o">=</span>/usr/sbin:/usr/bin:/sbin:/bin
*/1 * * * * /usr/local/sbin/mysql_check.sh
</code></pre></div>

<h3 id="step-3---improvement">Step 3 - Improvement</h3>

<p>I realize that this isn’t the most elegant solution, but it works for now, until I have the bandwidth to learn to use memcache like a boss. Any suggestions / feedback? Leave it in the comments section below. :)</p>


                    <ul class="list-linear">
                        <li><div class="twitter-tweet"><a href="https://twitter.com/share?url=http://jrrera.github.io//2014/05/05/preventing-mysql-from-randomly-stopping-on-ubuntu-1204&amp;text=Preventing MySQL from Randomly Stopping on Ubuntu 12.04" class="twitter-share-button" data-count="horizontal" data-via="jonguerrera" data-lang="en" data-url="http://jrrera.github.io//2014/05/05/preventing-mysql-from-randomly-stopping-on-ubuntu-1204">Tweet</a></div></li>
                        <li><div class="fb-share-button" data-href="/2014/05/05/preventing-mysql-from-randomly-stopping-on-ubuntu-1204" data-type="button_count"></div></li>
                        <li><div class="g-plusone" data-size="medium" data-href="/2014/05/05/preventing-mysql-from-randomly-stopping-on-ubuntu-1204"></div></li>
                    </ul>
                </div><!-- entry-content -->
            </div><!-- bd -->
        </div><!-- content -->
    </div><!-- unit-inner -->
    <hr />
    <hr />
</article>


  
    <article class="unit-article layout-post">
    <div class="unit-inner unit-article-inner">
        <div class="content">
            <div class="bd">
            	<a href="/angularjs/2014/04/05/a-better-way-to-integrate-angularjs-and-google-charts"><h1>A Better Way to Integrate AngularJS and Google Charts</h1></a>
            	<small>05 Apr 2014</small>
            	<hr />
                <div class="entry-content">
                    
<p><img src="/assets/img/AngularJS-large.png" alt="AngularJS" /></p>

<p>Last Updated: 4/12/2014</p>

<p>I’m fairly new to the world of web development (I <a href="http://www.livingforimprovement.com/learning-to-code-fun-frustrating-fruitful/">started coding</a> a year and half ago), and one of my favorite discoveries thus far is AngularJS. </p>

<p>As with many people new to Angular, the hardest concept to grok was that of directives. Whenever you’d like to manipulate the dom in some way, a directive is how you do it. Additionally, directives (along with services) are a great way to integrate third party libraries and APIs with Angular.</p>

<p>I’ve recently been working on a small <a href="https://github.com/jrrera/minimal-meditation">meditation timer app</a> and was having some trouble integrating the Google Charts / Visualization API with AngularJS. I found a solid starting point with <a href="http://gavindraper.com/2013/07/30/google-charts-in-angularjs/">Gavin Draper’s article</a> on how he did it.</p>

<p>His code samples were fantastic for getting me up and running. But as I continued to work on the application, I found a few disadvantages with that implementation, and figured it never hurts to improve on the great content of others. Here are a few areas I wanted to work on:</p>

<h3 id="bootstrapping-angular">Bootstrapping Angular</h3>

<div class="highlight"><pre><code class="javascript"><span class="nx">google</span><span class="p">.</span><span class="nx">setOnLoadCallback</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>  
    <span class="nx">angular</span><span class="p">.</span><span class="nx">bootstrap</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;my-app&#39;</span><span class="p">]);</span>
<span class="p">});</span>
<span class="nx">google</span><span class="p">.</span><span class="nx">load</span><span class="p">(</span><span class="s1">&#39;visualization&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="p">{</span><span class="nx">packages</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;corechart&#39;</span><span class="p">]});</span>
</code></pre></div>

<p>This is the code used to initialize the Angular application in Gavin’s post. The given code here works just fine, but I noticed that Angular’s bootstrap function only runs once the Google Loader fires off the callback function.</p>

<p>By requiring the Google Loader callback to fire before bootstrapping the Angular application, if the Google Loader ever falters, the app simply won’t run. That felt like an unacceptable trade-off.</p>

<p>A better approach would be to wrap the Googe Loader in an Angular Service, which I’ll explain how I did later in this post.</p>

<h3 id="nested-models">Nested models</h3>

<div class="highlight"><pre><code class="javascript"><span class="nx">googleChart</span><span class="p">.</span><span class="nx">directive</span><span class="p">(</span><span class="s2">&quot;googleChart&quot;</span><span class="p">,</span><span class="kd">function</span><span class="p">(){</span>  
    <span class="k">return</span><span class="p">{</span>
        <span class="nx">restrict</span> <span class="o">:</span> <span class="s2">&quot;A&quot;</span><span class="p">,</span>
        <span class="nx">link</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">$scope</span><span class="p">,</span> <span class="nx">$elem</span><span class="p">,</span> <span class="nx">$attr</span><span class="p">){</span>
            <span class="kd">var</span> <span class="nx">dt</span> <span class="o">=</span> <span class="nx">$scope</span><span class="p">[</span><span class="nx">$attr</span><span class="p">.</span><span class="nx">ngModel</span><span class="p">].</span><span class="nx">dataTable</span><span class="p">;</span>

            <span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{};</span>
            <span class="k">if</span><span class="p">(</span><span class="nx">$scope</span><span class="p">[</span><span class="nx">$attr</span><span class="p">.</span><span class="nx">ngModel</span><span class="p">].</span><span class="nx">title</span><span class="p">)</span>
                <span class="nx">options</span><span class="p">.</span><span class="nx">title</span> <span class="o">=</span> <span class="nx">$scope</span><span class="p">[</span><span class="nx">$attr</span><span class="p">.</span><span class="nx">ngModel</span><span class="p">].</span><span class="nx">title</span><span class="p">;</span>

            <span class="kd">var</span> <span class="nx">googleChart</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">google</span><span class="p">.</span><span class="nx">visualization</span><span class="p">[</span><span class="nx">$attr</span><span class="p">.</span><span class="nx">googleChart</span><span class="p">](</span><span class="nx">$elem</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
            <span class="nx">googleChart</span><span class="p">.</span><span class="nx">draw</span><span class="p">(</span><span class="nx">dt</span><span class="p">,</span><span class="nx">options</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">});</span>
</code></pre></div>

<p>The directive used in Gavin’s article wasn’t utilizing Angular’s useful <code>$scope.$eval</code> for <a href="http://stackoverflow.com/questions/15671471/angular-js-how-does-eval-work-and-why-is-it-different-from-vanilla-eval">reading attributes</a>. Rather, it was passing the ngModel attribute directly to the <code>$scope</code> object. If you had a nested model – a best practice in many situations – such as <code>$scope.chartModel.dataset1</code>, the directive would break by trying to do something like this <code>var dt = $scope['chartModel.dataset1'].dataTable;</code></p>

<p>As I mentioned, a better approach would be to use <code>$scope.$eval</code>, which will safely eval the attribute to give you access to the necessary model.</p>

<h3 id="unit-testing">Unit Testing</h3>

<p>The only other concern I had was, by calling google.load in the global scope, unit testing became more difficult. My Karma / Jasmine setup was failing because the google namespace wasn’t defined in the test environment when injecting my Angular app module. </p>

<p>Again, the way to avoid this problem is to keep the google namespace wrapped in an Angular Service so that it can be mocked and/or ignored in my various unit tests.</p>

<h3 id="a-better-solution">A Better Solution</h3>

<p>Given the drawbacks listed above, here’s how I ended up implementing Google Charts. I consider this to be a more ‘Angular’ way to do it, by relying more heavily on Angular services, watchers, and keeping the Google Loader in a nicely contained environment.</p>

<p>Let’s start with the DOM and the controller:</p>

<p><strong>DOM</strong>:</p>

<div class="highlight"><pre><code class="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>  
<span class="nt">&lt;html</span> <span class="na">lang=</span><span class="s">&quot;en&quot;</span> <span class="na">ng-app=</span><span class="s">&quot;myApp&quot;</span><span class="nt">&gt;</span>  
    <span class="nt">&lt;head&gt;</span>
         <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&quot;https://ajax.googleapis.com/ajax/libs/angularjs/1.2.15/angular.min.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
         <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&quot;https://www.google.com/jsapi&quot;</span> <span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
         <span class="c">&lt;!-- Place additional scripts for controller, directives, etc. here --&gt;</span>
    <span class="nt">&lt;/head&gt;</span>
    <span class="nt">&lt;body</span> <span class="na">ng-controller=</span><span class="s">&quot;ChartCtrl&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">google-chart=</span><span class="s">&quot;ColumnChart&quot;</span> <span class="na">ng-model=</span><span class="s">&quot;dataModel.visual&quot;</span> <span class="na">trigger=</span><span class="s">&quot;activateChart&quot;</span><span class="nt">&gt;&lt;/div&gt;</span>
    <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>  
</code></pre></div>

<p>Note that <code>$scope.activateChart</code> is going to be the trigger to build the chart. </p>

<p><strong>Controller</strong>:</p>

<div class="highlight"><pre><code class="javascript"><span class="kd">var</span> <span class="nx">app</span> <span class="o">=</span> <span class="nx">app</span> <span class="o">||</span> <span class="nx">angular</span><span class="p">.</span><span class="nx">module</span><span class="p">(</span><span class="s1">&#39;myApp&#39;</span><span class="p">,</span> <span class="p">[]);</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">controller</span><span class="p">(</span><span class="s1">&#39;ChartCtrl&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">$scope</span><span class="p">,</span> <span class="nx">ChartService</span><span class="p">)</span> <span class="p">{</span>
    
    <span class="c1">// activateChart flips to true once the Google </span>
    <span class="c1">// Loader callback fires</span>
    <span class="nx">$scope</span><span class="p">.</span><span class="nx">activateChart</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>

    <span class="c1">// This is where my data model will be stored.</span>
    <span class="c1">// &quot;visual&quot; will contain the chart&#39;s datatable</span>
    <span class="nx">$scope</span><span class="p">.</span><span class="nx">dataModel</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">visual</span><span class="o">:</span> <span class="p">{},</span>
        <span class="nx">metaData</span><span class="o">:</span> <span class="p">{},</span>
        <span class="nx">data</span><span class="o">:</span> <span class="p">{}</span>
    <span class="p">};</span>

    <span class="c1">// First, we attempt to load the Visualization module </span>
    <span class="kd">var</span> <span class="nx">loadGoogle</span> <span class="o">=</span> <span class="nx">ChartService</span><span class="p">.</span><span class="nx">loadGoogleVisualization</span><span class="p">();</span>
    
    <span class="c1">// If the Google Loader request was made with no errors, </span>
    <span class="c1">// register a callback, and construct the chart data</span>
    <span class="c1">// model within the callback function</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">loadGoogle</span><span class="p">)</span> <span class="p">{</span>

        <span class="nx">google</span><span class="p">.</span><span class="nx">setOnLoadCallback</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

            <span class="nx">$scope</span><span class="p">.</span><span class="nx">dataModel</span><span class="p">.</span><span class="nx">visual</span><span class="p">.</span><span class="nx">dataTable</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">google</span><span class="p">.</span><span class="nx">visualization</span><span class="p">.</span><span class="nx">DataTable</span><span class="p">();</span>

            <span class="c1">// Set up the dataTable and columns</span>
            <span class="kd">var</span> <span class="nx">dataTable</span> <span class="o">=</span> <span class="nx">$scope</span><span class="p">.</span><span class="nx">dataModel</span><span class="p">.</span><span class="nx">visual</span><span class="p">.</span><span class="nx">dataTable</span><span class="p">;</span>
            <span class="nx">dataTable</span><span class="p">.</span><span class="nx">addColumn</span><span class="p">(</span><span class="s2">&quot;string&quot;</span><span class="p">,</span><span class="s2">&quot;Date&quot;</span><span class="p">)</span>
            <span class="nx">dataTable</span><span class="p">.</span><span class="nx">addColumn</span><span class="p">(</span><span class="s2">&quot;number&quot;</span><span class="p">,</span><span class="s2">&quot;Minutes&quot;</span><span class="p">)</span>
            
            <span class="c1">// Populate row data</span>
            <span class="nx">dataTable</span><span class="p">.</span><span class="nx">addRow</span><span class="p">([</span><span class="s2">&quot;3/1/14&quot;</span><span class="p">,</span><span class="mi">5</span><span class="p">]);</span>
            <span class="nx">dataTable</span><span class="p">.</span><span class="nx">addRow</span><span class="p">([</span><span class="s2">&quot;3/2/14&quot;</span><span class="p">,</span><span class="mi">13</span><span class="p">]);</span>

            <span class="c1">// Update the model to activate the chart on the DOM</span>
            <span class="c1">// Note the use of $scope.$apply since we&#39;re in the </span>
            <span class="c1">// Google Loader callback.</span>
            <span class="nx">$scope</span><span class="p">.</span><span class="nx">$apply</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
                <span class="nx">$scope</span><span class="p">.</span><span class="nx">activateChart</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>    
            <span class="p">});</span>
        <span class="p">});</span>  
    <span class="p">}</span>
<span class="p">});</span>
</code></pre></div>

<p>Next, let’s look at the <strong>Angular Service</strong>. I chose to place google.load() in a try/catch block to guard against any errors that might spring up if any breaking changes are introduced in the future. </p>

<p>There’s also a quirk in the Google Loader worth noting: If you want to load an API <em>after</em> the page renders, you need to add an arbitrary callback, otherwise the loader will use document.write(), which will overwrite all of the HTML on the page.</p>

<div class="highlight"><pre><code class="javascript"><span class="nx">app</span><span class="p">.</span><span class="nx">factory</span><span class="p">(</span><span class="s1">&#39;ChartService&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">{</span>
        
        <span class="cm">/**</span>
<span class="cm">         * Loads the visualization module from the Google Charts API </span>
<span class="cm">         * if available</span>
<span class="cm">         * @returns {boolean} - Returns true is successful, or false </span>
<span class="cm">         * if not available</span>
<span class="cm">         */</span>
        <span class="nx">loadGoogleVisualization</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            
            <span class="c1">// Using a try/catch block to guard against unanticipated </span>
            <span class="c1">// errors when loading the visualization lib</span>
            <span class="k">try</span> <span class="p">{</span>

                <span class="c1">// Arbitrary callback required in google.load() to </span>
                <span class="c1">// support loading after initial page rendering</span>
                <span class="nx">google</span><span class="p">.</span><span class="nx">load</span><span class="p">(</span><span class="s1">&#39;visualization&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="p">{</span>
                    <span class="s1">&#39;callback&#39;</span><span class="o">:</span><span class="s1">&#39;console.log(\&#39;success\&#39;);&#39;</span><span class="p">,</span> 
                    <span class="s1">&#39;packages&#39;</span><span class="o">:</span><span class="p">[</span><span class="s1">&#39;corechart&#39;</span><span class="p">]</span>
                <span class="p">});</span>
               
                <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
            
            <span class="p">}</span> <span class="k">catch</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Could not load Google lib&#39;</span><span class="p">,</span> <span class="nx">e</span><span class="p">);</span>
                <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>  
            <span class="p">}</span>

        <span class="p">}</span>
    <span class="p">};</span>
<span class="p">});</span>
</code></pre></div>

<p>And finally, let’s take a look at the underlying directive.</p>

<p><strong>Directive</strong>:</p>

<div class="highlight"><pre><code class="javascript"><span class="nx">app</span><span class="p">.</span><span class="nx">directive</span><span class="p">(</span><span class="s2">&quot;googleChart&quot;</span><span class="p">,</span><span class="kd">function</span><span class="p">(){</span>  
    <span class="k">return</span><span class="p">{</span>
        <span class="nx">restrict</span> <span class="o">:</span> <span class="s2">&quot;A&quot;</span><span class="p">,</span>
        <span class="nx">link</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">$scope</span><span class="p">,</span> <span class="nx">$elem</span><span class="p">,</span> <span class="nx">$attr</span><span class="p">){</span>
            <span class="kd">var</span> <span class="nx">model</span><span class="p">;</span>

            <span class="c1">// Function to run when the trigger is activated</span>
            <span class="kd">var</span> <span class="nx">initChart</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

                <span class="c1">// Run $eval on the $scope model passed </span>
                <span class="c1">// as an HTML attribute</span>
                <span class="nx">model</span> <span class="o">=</span> <span class="nx">$scope</span><span class="p">.</span><span class="nx">$eval</span><span class="p">(</span><span class="nx">$attr</span><span class="p">.</span><span class="nx">ngModel</span><span class="p">);</span>
                
                <span class="c1">// If the model is defined on the scope,</span>
                <span class="c1">// grab the dataTable that was set up</span>
                <span class="c1">// during the Google Loader callback</span>
                <span class="c1">// function, and draw the chart</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">model</span><span class="p">)</span> <span class="p">{</span>
                    <span class="kd">var</span> <span class="nx">dt</span> <span class="o">=</span> <span class="nx">model</span><span class="p">.</span><span class="nx">dataTable</span><span class="p">,</span>
                        <span class="nx">options</span> <span class="o">=</span> <span class="p">{},</span>
                        <span class="nx">chartType</span> <span class="o">=</span> <span class="nx">$attr</span><span class="p">.</span><span class="nx">googleChart</span><span class="p">;</span>

                    <span class="k">if</span> <span class="p">(</span><span class="nx">model</span><span class="p">.</span><span class="nx">title</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">options</span><span class="p">.</span><span class="nx">title</span> <span class="o">=</span> <span class="nx">model</span><span class="p">.</span><span class="nx">title</span><span class="p">;</span>
                    <span class="p">}</span>
                    
                    <span class="kd">var</span> <span class="nx">googleChart</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">google</span><span class="p">.</span><span class="nx">visualization</span><span class="p">[</span><span class="nx">chartType</span><span class="p">](</span><span class="nx">$elem</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
                    <span class="nx">googleChart</span><span class="p">.</span><span class="nx">draw</span><span class="p">(</span><span class="nx">dt</span><span class="p">,</span><span class="nx">options</span><span class="p">)</span>
                <span class="p">}</span>
            <span class="p">};</span>

            <span class="c1">// Watch the scope value placed on the trigger attribute</span>
            <span class="c1">// if it ever flips to true, activate the chart</span>
            <span class="nx">$scope</span><span class="p">.</span><span class="nx">$watch</span><span class="p">(</span><span class="nx">$attr</span><span class="p">.</span><span class="nx">trigger</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">val</span><span class="p">){</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">val</span> <span class="o">===</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">initChart</span><span class="p">();</span> 
                <span class="p">}</span>
            <span class="p">});</span>
            
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">});</span>
</code></pre></div>

<p>And there you have it! Google Visualization Charts right in your Angular application without any worries of Google Loader failure, unit testing difficulties, or data model restrictions. </p>

<p>Granted, I’m still a beginner to AngularJS (I’ve only been writing Angular apps for 7-8 months now), so if you see any faults here, definitely point it out in the comments below! For starters, it probably would’ve made more sense to register the Google Loader callback in the service, rather than the controller. Comment if you agree!</p>

<p>-Jon</p>

                    <ul class="list-linear">
                        <li><div class="twitter-tweet"><a href="https://twitter.com/share?url=http://jrrera.github.io//angularjs/2014/04/05/a-better-way-to-integrate-angularjs-and-google-charts&amp;text=A Better Way to Integrate AngularJS and Google Charts" class="twitter-share-button" data-count="horizontal" data-via="jonguerrera" data-lang="en" data-url="http://jrrera.github.io//angularjs/2014/04/05/a-better-way-to-integrate-angularjs-and-google-charts">Tweet</a></div></li>
                        <li><div class="fb-share-button" data-href="/angularjs/2014/04/05/a-better-way-to-integrate-angularjs-and-google-charts" data-type="button_count"></div></li>
                        <li><div class="g-plusone" data-size="medium" data-href="/angularjs/2014/04/05/a-better-way-to-integrate-angularjs-and-google-charts"></div></li>
                    </ul>
                </div><!-- entry-content -->
            </div><!-- bd -->
        </div><!-- content -->
    </div><!-- unit-inner -->
    <hr />
    <hr />
</article>


  
    <article class="unit-article layout-post">
    <div class="unit-inner unit-article-inner">
        <div class="content">
            <div class="bd">
            	<a href="/2014/04/04/installing-jekyll-on-os-x-1092"><h1>Installing Jekyll on OS X 10.9.2</h1></a>
            	<small>04 Apr 2014</small>
            	<hr />
                <div class="entry-content">
                    
<p>Ironically, as I was trying to install Jekyll to set up this blog on Github, I ran into a lot of problems. The command-line error wasn’t too helpful but it looked something like this:</p>

<pre><code>Building native extensions.  This could take a while...
ERROR:  Error installing jekyll:
	ERROR: Failed to build gem native extension.

    /System/Library/Frameworks/Ruby.framework/Versions/2.0/usr/bin/ruby extconf.rb
creating Makefile

make "DESTDIR=" clean

make "DESTDIR="
compiling porter.c
porter.c:359:27: warning: '&amp;&amp;' within '||' [-Wlogical-op-parentheses]
      if (a &gt; 1 || a == 1 &amp;&amp; !cvc(z, z-&gt;k - 1)) z-&gt;k--;
                ~~ ~~~~~~~^~~~~~~~~~~~~~~~~~~~
porter.c:359:27: note: place parentheses around the '&amp;&amp;' expression to silence this warning
      if (a &gt; 1 || a == 1 &amp;&amp; !cvc(z, z-&gt;k - 1)) z-&gt;k--;
                          ^
                   (                          )
1 warning generated.
compiling porter_wrap.c
linking shared-object stemmer.bundle
clang: error: unknown argument: '-multiply_definedsuppress' [-Wunused-command-line-argument-hard-error-in-future]
clang: note: this will be a hard error (cannot be downgraded to a warning) in the future
make: *** [stemmer.bundle] Error 1

make failed, exit code 2

Gem files will remain installed in /Library/Ruby/Gems/2.0.0/gems/fast-stemmer-1.0.2 for inspection.
Results logged to /Library/Ruby/Gems/2.0.0/extensions/universal-darwin-13/2.0.0/fast-stemmer-1.0.2/gem_make.out
</code></pre>

<p>Both the <a href="http://jekyllrb.com/docs/troubleshooting/">Jekyll troubleshooting page</a> and StackOverflow recommended two ways to resolve installation issues:</p>

<ul>
  <li>Making sure <a href="https://developer.apple.com/downloads/index.action?name=for%20Xcode%20-#">commandline tools</a> was installed</li>
  <li>Making sure RubyGems was up to date with <code>sudo gem update --system</code></li>
</ul>

<p>However, neither of these did the trick for me. Thankfully, after an hour of searching, I ended up finding the right clues <a href="http://stackoverflow.com/questions/22479246/how-to-install-jekyll-on-mac-osx-10-9-with-ruby-2-0-0">here</a>.</p>

<p>As per the StackOverflow link above, I installed Homebrew and RVM, <a href="http://dean.io/setting-up-a-ruby-on-rails-development-environment-on-mavericks/">using this guide</a>; this did the trick. Success!</p>

<p>While I do wonder why RVM / Homebrew was necessary, it seems to be working for others as well. Thought I’d call it out for any others struggling out there, as I had difficulty finding the right clues on Stack Overflow.</p>

                    <ul class="list-linear">
                        <li><div class="twitter-tweet"><a href="https://twitter.com/share?url=http://jrrera.github.io//2014/04/04/installing-jekyll-on-os-x-1092&amp;text=Installing Jekyll on OS X 10.9.2" class="twitter-share-button" data-count="horizontal" data-via="jonguerrera" data-lang="en" data-url="http://jrrera.github.io//2014/04/04/installing-jekyll-on-os-x-1092">Tweet</a></div></li>
                        <li><div class="fb-share-button" data-href="/2014/04/04/installing-jekyll-on-os-x-1092" data-type="button_count"></div></li>
                        <li><div class="g-plusone" data-size="medium" data-href="/2014/04/04/installing-jekyll-on-os-x-1092"></div></li>
                    </ul>
                </div><!-- entry-content -->
            </div><!-- bd -->
        </div><!-- content -->
    </div><!-- unit-inner -->
    <hr />
    <hr />
</article>


  
</ul>

				</div><!-- entry-content -->
			</div><!-- bd -->

			<footer class="unit-foot">
				<div class="unit-inner unit-foot-inner">
					<p class="gotop">
						<a href="#page">Back to Top</a>
					</p>
				</div>
			</footer>

		</div><!-- content -->
	</div><!-- unit-inner -->
</article>


				</div>
			</div><!-- unit-inner -->
		</div><!-- unit-body -->
	</div><!-- body -->
	<footer class="the-footer">
		<div class="unit-foot">
			<div class="unit-inner unit-foot-inner">
				<div class="misc vcard">
					<h4>about</h4>
					<ul>
						<li class="contact"><address><span class="author fn n">Jonathan Guerrera</span> - <span class="fn email">jrrera@gmail.com</span></address></li>
						<li class="github"><a href="http://github.com/jrrera/" rel="me">github.com/jrrera</a></li>
						<li class="twitter"><a href="http://twitter.com/jonguerrera/" rel="me">twitter.com/jonguerrera</a></li>
						<li class="rss"><a href="http://feeds.feedburner.com/">Subscribe to RSS Feed</a></li>
					</ul>
				</div><!-- misc -->
				<p class="licence">
					Theme: <a href="http://layouts-the.me">the_minimum</a> based on <a href="http://jekyllbootstrap.com/">Jekyll-bootstrap</a>.<br>
					Powered by <a href="https://github.com/mojombo/jekyll">Jekyll</a>.
				</p>
			</div><!-- unit-foot-inner -->
		</div><!-- unit-foot -->
	</footer>
</div><!-- page -->

<!--Begin Facebook code, instructed to be after opening body tag, but placing down here instead-->
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=788897974471796";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<!--End Facebook code-->

<script>
	(function(d, s) {
		var js, fjs = d.getElementsByTagName(s)[0], load = function(url, id) {
		if (d.getElementById(id)) {return;}
		js = d.createElement(s); js.src = url; js.id = id;
		fjs.parentNode.insertBefore(js, fjs);
		};
	load('//platform.twitter.com/widgets.js', 'tweetjs');
	load('https://apis.google.com/js/plusone.js', 'gplus1js'); // Checkout http://j.mp/ApDgMr for usage html for this is <div class="g-plusone" data-size="medium"></div>
	// load('//connect.facebook.net/en_US/all.js#xfbml=1', 'fbjssdk'); // Checkout http://j.mp/wZw2xR for using open graph protorol html for this is <div class="fb-like" data-href="/index.html" data-send="false" data-layout="button_count" data-width="450" data-show-faces="false" data-font="verdana"></div>
	}(document, 'script'));
</script>
<script>
/*! A fix for the iOS orientationchange zoom bug.Script by @scottjehl, rebound by @wilto. MIT License.*/
(function(j){var i=j.document;if(!i.querySelectorAll){return}var l=i.querySelectorAll("meta[name=viewport]")[0],a=l&&l.getAttribute("content"),h=a+", maximum-scale=1.0",d=a+", maximum-scale=10.0",g=true,c=j.orientation,k=0;if(!l){return}function f(){l.setAttribute("content",d);g=true}function b(){l.setAttribute("content",h);g=false}function e(m){c=Math.abs(j.orientation);k=Math.abs(m.gamma);if(k>8&&c===0){if(g){b()}}else{if(!g){f()}}}j.addEventListener("orientationchange",f,false);j.addEventListener("deviceorientation",e,false)})(this);
</script>

  
</body>
</html>

